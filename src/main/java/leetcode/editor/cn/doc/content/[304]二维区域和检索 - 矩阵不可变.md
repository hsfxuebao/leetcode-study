<p><big><small>ç»™å®šä¸€ä¸ªäºŒç»´çŸ©é˜µ <code>matrix</code>ï¼Œ</small></big>ä»¥ä¸‹ç±»å‹çš„å¤šä¸ªè¯·æ±‚ï¼š</p>

<ul> 
 <li><big><small>è®¡ç®—å…¶å­çŸ©å½¢èŒƒå›´å†…å…ƒç´ çš„æ€»å’Œï¼Œè¯¥å­çŸ©é˜µçš„ <strong>å·¦ä¸Šè§’</strong> ä¸º <code>(row1,&nbsp;col1)</code> ï¼Œ<strong>å³ä¸‹è§’</strong> ä¸º <code>(row2,&nbsp;col2)</code> ã€‚</small></big></li> 
</ul>

<p>å®ç° <code>NumMatrix</code> ç±»ï¼š</p>

<ul> 
 <li><code>NumMatrix(int[][] matrix)</code>&nbsp;ç»™å®šæ•´æ•°çŸ©é˜µ <code>matrix</code> è¿›è¡Œåˆå§‹åŒ–</li> 
 <li><code>int sumRegion(int row1, int col1, int row2, int col2)</code>&nbsp;è¿”å›<big><small> <strong>å·¦ä¸Šè§’</strong></small></big><big><small> <code>(row1,&nbsp;col1)</code>&nbsp;ã€<strong>å³ä¸‹è§’</strong>&nbsp;<code>(row2,&nbsp;col2)</code></small></big> æ‰€æè¿°çš„å­çŸ©é˜µçš„å…ƒç´  <strong>æ€»å’Œ</strong> ã€‚</li> 
</ul>

<p>&nbsp;</p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>

<p><img src="https://pic.leetcode-cn.com/1626332422-wUpUHT-image.png" style="width: 200px;" /></p>

<pre>
<strong>è¾“å…¥:</strong> 
["NumMatrix","sumRegion","sumRegion","sumRegion"]
[[[[3,0,1,4,2],[5,6,3,2,1],[1,2,0,1,5],[4,1,0,1,7],[1,0,3,0,5]]],[2,1,4,3],[1,1,2,2],[1,2,2,4]]
<strong>è¾“å‡º:</strong> 
[null, 8, 11, 12]

<strong>è§£é‡Š:</strong>
NumMatrix numMatrix = new NumMatrix([[3,0,1,4,2],[5,6,3,2,1],[1,2,0,1,5],[4,1,0,1,7],[1,0,3,0,5]]);
numMatrix.sumRegion(2, 1, 4, 3); // return 8 (çº¢è‰²çŸ©å½¢æ¡†çš„å…ƒç´ æ€»å’Œ)
numMatrix.sumRegion(1, 1, 2, 2); // return 11 (ç»¿è‰²çŸ©å½¢æ¡†çš„å…ƒç´ æ€»å’Œ)
numMatrix.sumRegion(1, 2, 2, 4); // return 12 (è“è‰²çŸ©å½¢æ¡†çš„å…ƒç´ æ€»å’Œ)
</pre>

<p>&nbsp;</p>

<p><strong>æç¤ºï¼š</strong></p>

<ul> 
 <li><code>m == matrix.length</code></li> 
 <li><code>n == matrix[i].length</code></li> 
 <li><code>1 &lt;= m,&nbsp;n &lt;=&nbsp;200</code>
  <meta charset="UTF-8" /></li> 
 <li><code>-10<sup>5</sup>&nbsp;&lt;= matrix[i][j] &lt;= 10<sup>5</sup></code></li> 
 <li><code>0 &lt;= row1 &lt;= row2 &lt; m</code></li> 
 <li><code>0 &lt;= col1 &lt;= col2 &lt; n</code></li> 
 <li>
  <meta charset="UTF-8" />æœ€å¤šè°ƒç”¨ <code>10<sup>4</sup></code> æ¬¡&nbsp;<code>sumRegion</code> æ–¹æ³•</li> 
</ul>

<details><summary><strong>Related Topics</strong></summary>è®¾è®¡ | æ•°ç»„ | çŸ©é˜µ | å‰ç¼€å’Œ</details><br>

<div>ğŸ‘ 486, ğŸ‘ 0<span style='float: right;'><span style='color: gray;'><a href='https://github.com/labuladong/fucking-algorithm/discussions/939' target='_blank' style='color: lightgray;text-decoration: underline;'>bug åé¦ˆ</a> | <a href='https://labuladong.gitee.io/article/fname.html?fname=jbæ’ä»¶ç®€ä»‹' target='_blank' style='color: lightgray;text-decoration: underline;'>ä½¿ç”¨æŒ‡å—</a> | <a href='https://labuladong.github.io/algo/images/others/%E5%85%A8%E5%AE%B6%E6%A1%B6.jpg' target='_blank' style='color: lightgray;text-decoration: underline;'>æ›´å¤šé…å¥—æ’ä»¶</a></span></span></div>

<div id="labuladong"><hr>

</div>





æ•°æ®ç»“æ„ç²¾å“è¯¾](https://aep.h5.xeknow.com/s/1XJHEO) å·²æ›´æ–°åˆ° V2.1ï¼Œ[æ‰‹æŠŠæ‰‹åˆ·äºŒå‰æ ‘ç³»åˆ—è¯¾ç¨‹](https://aep.xet.tech/s/3YGcq3) ä¸Šçº¿ã€‚**



<p><strong><a href="https://labuladong.github.io/article/slug.html?slug=range-sum-query-2d-immutable" target="_blank">â­ï¸labuladong é¢˜è§£</a></strong></p>
<details><summary><strong>labuladong æ€è·¯</strong></summary>

## åŸºæœ¬æ€è·¯

> æœ¬æ–‡æœ‰è§†é¢‘ç‰ˆï¼š[å‰ç¼€å’Œ/å·®åˆ†æ•°ç»„æŠ€å·§ç²¾è®²](https://www.bilibili.com/video/BV1NY4y1J7xQ)

è¿™é¢˜çš„æ€è·¯å’Œ [303. åŒºåŸŸå’Œæ£€ç´¢ - æ•°ç»„ä¸å¯å˜](/problems/range-sum-query-immutable) ä¸­ä¸€ç»´æ•°ç»„ä¸­çš„å‰ç¼€å’Œé—®é¢˜æ˜¯éå¸¸ç±»ä¼¼çš„ï¼Œå¦‚ä¸‹å›¾ï¼š

![](https://labuladong.github.io/pictures/å‰ç¼€å’Œ/5.jpeg)

å¦‚æœæˆ‘æƒ³è®¡ç®—çº¢è‰²çš„è¿™ä¸ªå­çŸ©é˜µçš„å…ƒç´ ä¹‹å’Œï¼Œå¯ä»¥ç”¨ç»¿è‰²çŸ©é˜µå‡å»è“è‰²çŸ©é˜µå‡å»æ©™è‰²çŸ©é˜µæœ€ååŠ ä¸Šç²‰è‰²çŸ©é˜µï¼Œè€Œç»¿è“æ©™ç²‰è¿™å››ä¸ªçŸ©é˜µæœ‰ä¸€ä¸ªå…±åŒçš„ç‰¹ç‚¹ï¼Œå°±æ˜¯å·¦ä¸Šè§’å°±æ˜¯ `(0, 0)` åŸç‚¹ã€‚

é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç»´æŠ¤ä¸€ä¸ªäºŒç»´ `preSum` æ•°ç»„ï¼Œä¸“é—¨è®°å½•ä»¥åŸç‚¹ä¸ºé¡¶ç‚¹çš„çŸ©é˜µçš„å…ƒç´ ä¹‹å’Œï¼Œå°±å¯ä»¥ç”¨å‡ æ¬¡åŠ å‡è¿ç®—ç®—å‡ºä»»ä½•ä¸€ä¸ªå­çŸ©é˜µçš„å…ƒç´ å’Œã€‚

**è¯¦ç»†é¢˜è§£ï¼š[å°è€Œç¾çš„ç®—æ³•æŠ€å·§ï¼šå‰ç¼€å’Œæ•°ç»„](https://labuladong.github.io/article/fname.html?fname=å‰ç¼€å’ŒæŠ€å·§)**

**æ ‡ç­¾ï¼šå‰ç¼€å’Œ**

## è§£æ³•ä»£ç 

æç¤ºï¼šğŸŸ¢ æ ‡è®°çš„æ˜¯æˆ‘å†™çš„è§£æ³•ä»£ç ï¼ŒğŸ¤– æ ‡è®°çš„æ˜¯ chatGPT ç¿»è¯‘çš„å¤šè¯­è¨€è§£æ³•ä»£ç ã€‚å¦‚æœ‰é”™è¯¯ï¼Œå¯ä»¥ [ç‚¹è¿™é‡Œ](https://github.com/labuladong/fucking-algorithm/issues/1113) åé¦ˆå’Œä¿®æ­£ã€‚

<div class="tab-panel"><div class="tab-nav">
<button data-tab-item="cpp" class="tab-nav-button btn " data-tab-group="default" onclick="switchTab(this)">cppğŸ¤–</button>

<button data-tab-item="python" class="tab-nav-button btn " data-tab-group="default" onclick="switchTab(this)">pythonğŸ¤–</button>

<button data-tab-item="java" class="tab-nav-button btn active" data-tab-group="default" onclick="switchTab(this)">javağŸŸ¢</button>

<button data-tab-item="go" class="tab-nav-button btn " data-tab-group="default" onclick="switchTab(this)">goğŸ¤–</button>

<button data-tab-item="javascript" class="tab-nav-button btn " data-tab-group="default" onclick="switchTab(this)">javascriptğŸ¤–</button>
</div><div class="tab-content">
<div data-tab-item="cpp" class="tab-item " data-tab-group="default"><div class="highlight">

```cpp
// æ³¨æ„ï¼šcpp ä»£ç ç”± chatGPTğŸ¤– æ ¹æ®æˆ‘çš„ java ä»£ç ç¿»è¯‘ï¼Œæ—¨åœ¨å¸®åŠ©ä¸åŒèƒŒæ™¯çš„è¯»è€…ç†è§£ç®—æ³•é€»è¾‘ã€‚
// æœ¬ä»£ç å·²ç»é€šè¿‡åŠ›æ‰£çš„æµ‹è¯•ç”¨ä¾‹ï¼Œåº”è¯¥å¯ç›´æ¥æˆåŠŸæäº¤ã€‚

class NumMatrix {
private:
    // preSum[i][j] è®°å½•çŸ©é˜µ [0, 0, i, j] çš„å…ƒç´ å’Œ
    vector<vector<int>> preSum;

public:
    NumMatrix(vector<vector<int>>& matrix) {
        int m = matrix.size(), n = matrix[0].size();
        if (m == 0 || n == 0) return;
        // æ„é€ å‰ç¼€å’ŒçŸ©é˜µ
        preSum = vector<vector<int>>(m + 1, vector<int>(n + 1, 0));
        for (int i = 1; i <= m; i++) {
            for (int j = 1; j <= n; j++) {
                // è®¡ç®—æ¯ä¸ªçŸ©é˜µ [0, 0, i, j] çš„å…ƒç´ å’Œ
                preSum[i][j] = preSum[i-1][j] + preSum[i][j-1] + matrix[i - 1][j - 1] - preSum[i-1][j-1];
            }
        }
    }

    // è®¡ç®—å­çŸ©é˜µ [x1, y1, x2, y2] çš„å…ƒç´ å’Œ
    int sumRegion(int x1, int y1, int x2, int y2) {
        // ç›®æ ‡çŸ©é˜µä¹‹å’Œç”±å››ä¸ªç›¸é‚»çŸ©é˜µè¿ç®—è·å¾—
        return preSum[x2+1][y2+1] - preSum[x1][y2+1] - preSum[x2+1][y1] + preSum[x1][y1];
    }
};
```

</div></div>

<div data-tab-item="python" class="tab-item " data-tab-group="default"><div class="highlight">

```python
# æ³¨æ„ï¼špython ä»£ç ç”± chatGPTğŸ¤– æ ¹æ®æˆ‘çš„ java ä»£ç ç¿»è¯‘ï¼Œæ—¨åœ¨å¸®åŠ©ä¸åŒèƒŒæ™¯çš„è¯»è€…ç†è§£ç®—æ³•é€»è¾‘ã€‚
# æœ¬ä»£ç å·²ç»é€šè¿‡åŠ›æ‰£çš„æµ‹è¯•ç”¨ä¾‹ï¼Œåº”è¯¥å¯ç›´æ¥æˆåŠŸæäº¤ã€‚

class NumMatrix:
    # preSum[i][j] è®°å½•çŸ©é˜µ [0, 0, i, j] çš„å…ƒç´ å’Œ
    def __init__(self, matrix: List[List[int]]):
        m, n = len(matrix), len(matrix[0])
        if m == 0 or n == 0:
            return
        # æ„é€ å‰ç¼€å’ŒçŸ©é˜µ
        self.preSum = [[0] * (n + 1) for _ in range(m + 1)]
        for i in range(1, m + 1):
            for j in range(1, n + 1):
                # è®¡ç®—æ¯ä¸ªçŸ©é˜µ [0, 0, i, j] çš„å…ƒç´ å’Œ
                self.preSum[i][j] = self.preSum[i - 1][j] + self.preSum[i][j - 1] + matrix[i - 1][j - 1] - self.preSum[i - 1][j - 1]

    # è®¡ç®—å­çŸ©é˜µ [x1, y1, x2, y2] çš„å…ƒç´ å’Œ
    def sumRegion(self, x1: int, y1: int, x2: int, y2: int) -> int:
        # ç›®æ ‡çŸ©é˜µä¹‹å’Œç”±å››ä¸ªç›¸é‚»çŸ©é˜µè¿ç®—è·å¾—
        return self.preSum[x2 + 1][y2 + 1] - self.preSum[x1][y2 + 1] - self.preSum[x2 + 1][y1] + self.preSum[x1][y1]
```

</div></div>

<div data-tab-item="java" class="tab-item active" data-tab-group="default"><div class="highlight">

```java
class NumMatrix {
    // preSum[i][j] è®°å½•çŸ©é˜µ [0, 0, i-1, j-1] çš„å…ƒç´ å’Œ
    private int[][] preSum;

    public NumMatrix(int[][] matrix) {
        int m = matrix.length, n = matrix[0].length;
        if (m == 0 || n == 0) return;
        // æ„é€ å‰ç¼€å’ŒçŸ©é˜µ
        preSum = new int[m + 1][n + 1];
        for (int i = 1; i <= m; i++) {
            for (int j = 1; j <= n; j++) {
                // è®¡ç®—æ¯ä¸ªçŸ©é˜µ [0, 0, i, j] çš„å…ƒç´ å’Œ
                preSum[i][j] = preSum[i-1][j] + preSum[i][j-1] + matrix[i - 1][j - 1] - preSum[i-1][j-1];
            }
        }
    }

    // è®¡ç®—å­çŸ©é˜µ [x1, y1, x2, y2] çš„å…ƒç´ å’Œ
    public int sumRegion(int x1, int y1, int x2, int y2) {
        // ç›®æ ‡çŸ©é˜µä¹‹å’Œç”±å››ä¸ªç›¸é‚»çŸ©é˜µè¿ç®—è·å¾—
        return preSum[x2+1][y2+1] - preSum[x1][y2+1] - preSum[x2+1][y1] + preSum[x1][y1];
    }
}
```

</div></div>

<div data-tab-item="go" class="tab-item " data-tab-group="default"><div class="highlight">

```go
// æ³¨æ„ï¼šgo ä»£ç ç”± chatGPTğŸ¤– æ ¹æ®æˆ‘çš„ java ä»£ç ç¿»è¯‘ï¼Œæ—¨åœ¨å¸®åŠ©ä¸åŒèƒŒæ™¯çš„è¯»è€…ç†è§£ç®—æ³•é€»è¾‘ã€‚
// æœ¬ä»£ç å·²ç»é€šè¿‡åŠ›æ‰£çš„æµ‹è¯•ç”¨ä¾‹ï¼Œåº”è¯¥å¯ç›´æ¥æˆåŠŸæäº¤ã€‚

type NumMatrix struct {
    // preSum[i][j] è®°å½•çŸ©é˜µ [0, 0, i, j] çš„å…ƒç´ å’Œ
    preSum [][]int
}

func Constructor(matrix [][]int) NumMatrix {
    m, n := len(matrix), len(matrix[0])
    if m == 0 || n == 0 {
        return NumMatrix{}
    }
    // æ„é€ å‰ç¼€å’ŒçŸ©é˜µ
    preSum := make([][]int, m+1)
    for i := 0; i <= m; i++ {
        preSum[i] = make([]int, n+1)
    }
    for i := 1; i <= m; i++ {
        for j := 1; j <= n; j++ {
            // è®¡ç®—æ¯ä¸ªçŸ©é˜µ [0, 0, i, j] çš„å…ƒç´ å’Œ
            preSum[i][j] = preSum[i-1][j] + preSum[i][j-1] + matrix[i-1][j-1] - preSum[i-1][j-1]
        }
    }
    return NumMatrix{preSum: preSum}
}

func (this *NumMatrix) SumRegion(x1 int, y1 int, x2 int, y2 int) int {
    // ç›®æ ‡çŸ©é˜µä¹‹å’Œç”±å››ä¸ªç›¸é‚»çŸ©é˜µè¿ç®—è·å¾—
    return this.preSum[x2+1][y2+1] - this.preSum[x1][y2+1] - this.preSum[x2+1][y1] + this.preSum[x1][y1]
}
```

</div></div>

<div data-tab-item="javascript" class="tab-item " data-tab-group="default"><div class="highlight">

```javascript
// æ³¨æ„ï¼šjavascript ä»£ç ç”± chatGPTğŸ¤– æ ¹æ®æˆ‘çš„ java ä»£ç ç¿»è¯‘ï¼Œæ—¨åœ¨å¸®åŠ©ä¸åŒèƒŒæ™¯çš„è¯»è€…ç†è§£ç®—æ³•é€»è¾‘ã€‚
// æœ¬ä»£ç å·²ç»é€šè¿‡åŠ›æ‰£çš„æµ‹è¯•ç”¨ä¾‹ï¼Œåº”è¯¥å¯ç›´æ¥æˆåŠŸæäº¤ã€‚

/**
 * @param {number[][]} matrix çŸ©é˜µ
 */
var NumMatrix = function(matrix) {
  const m = matrix.length, n = matrix[0].length;
  if (m == 0 || n == 0) return;
  // preSum[i][j] è®°å½•çŸ©é˜µ [0, 0, i, j] çš„å…ƒç´ å’Œ
  this.preSum = new Array(m + 1).fill().map(() => new Array(n + 1).fill(0));
  for (let i = 1; i <= m; i++) {
    for (let j = 1; j <= n; j++) {
      // è®¡ç®—æ¯ä¸ªçŸ©é˜µ [0, 0, i, j] çš„å…ƒç´ å’Œ
      this.preSum[i][j] = this.preSum[i - 1][j] + this.preSum[i][j - 1] + matrix[i - 1][j - 1] - this.preSum[i - 1][j - 1];
    }
  }
};

/**
 * @param {number} x1 å­çŸ©é˜µå·¦ä¸Šè§’åæ ‡x
 * @param {number} y1 å­çŸ©é˜µå·¦ä¸Šè§’åæ ‡y
 * @param {number} x2 å­çŸ©é˜µå³ä¸‹è§’åæ ‡x
 * @param {number} y2 å­çŸ©é˜µå³ä¸‹è§’åæ ‡y
 * @return {number} å­çŸ©é˜µå…ƒç´ å’Œ
 */
NumMatrix.prototype.sumRegion = function(x1, y1, x2, y2) {
  // ç›®æ ‡çŸ©é˜µä¹‹å’Œç”±å››ä¸ªç›¸é‚»çŸ©é˜µè¿ç®—è·å¾—
  return this.preSum[x2 + 1][y2 + 1] - this.preSum[x1][y2 + 1] - this.preSum[x2 + 1][y1] + this.preSum[x1][y1];
};
```

</div></div>
</div></div>

**ç±»ä¼¼é¢˜ç›®**ï¼š
  - [1314. çŸ©é˜µåŒºåŸŸå’Œ ğŸŸ ](/problems/matrix-block-sum)
  - [303. åŒºåŸŸå’Œæ£€ç´¢ - æ•°ç»„ä¸å¯å˜ ğŸŸ¢](/problems/range-sum-query-immutable)
  - [å‰‘æŒ‡ Offer II 013. äºŒç»´å­çŸ©é˜µçš„å’Œ ğŸŸ ](/problems/O4NDxx)

</details>
</div>



